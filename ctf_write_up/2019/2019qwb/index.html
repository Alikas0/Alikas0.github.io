



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://blog.lantern.cool/ctf_write_up/2019/2019qwb/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="https://raw.githubusercontent.com/Alikas0/files/master/videos/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>2019 强网杯 - Latern’station</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/gitalk.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="lime">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#justre" tabindex="0" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://blog.lantern.cool" title="Latern’station" aria-label="Latern’station" class="md-header-nav__button md-logo">
          
            <i class="md-icon">border_color</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Latern’station
            </span>
            <span class="md-header-nav__topic">
              
                2019 强网杯
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Alikas0/blog_code/tree/master/blog_code/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    blog_code
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://blog.lantern.cool" title="Latern’station" class="md-nav__button md-logo">
      
        <i class="md-icon">border_color</i>
      
    </a>
    Latern’station
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Alikas0/blog_code/tree/master/blog_code/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    blog_code
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Homepage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Homepage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../.." title="主页" class="md-nav__link">
      主页
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../links/" title="友情链接" class="md-nav__link">
      友情链接
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      CTF Write-Up
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        CTF Write-Up
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2018/2018rctf/" title="2018 RCTF" class="md-nav__link">
      2018 RCTF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" checked>
    
    <label class="md-nav__link" for="nav-2-2">
      2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../2019suctf/" title="2019 SUCTF" class="md-nav__link">
      2019 SUCTF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019aurora/" title="2019 Aurora内部赛" class="md-nav__link">
      2019 Aurora内部赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019rctf/" title="2019 RCTF国际赛" class="md-nav__link">
      2019 RCTF国际赛
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019starctf/" title="2019 *CTF" class="md-nav__link">
      2019 *CTF
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2019 强网杯
      </label>
    
    <a href="./" title="2019 强网杯" class="md-nav__link md-nav__link--active">
      2019 强网杯
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#justre" class="md-nav__link">
    JustRe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_ad" class="md-nav__link">
    强网先锋_AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webassembly" class="md-nav__link">
    webassembly
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019redhat/" title="2019 红帽杯" class="md-nav__link">
      2019 红帽杯
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      2020
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        2020
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2020/2020gaoxiaozhanyi/" title="2020 高校战疫" class="md-nav__link">
      2020 高校战疫
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Exams
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Exams
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-1" type="checkbox" id="nav-2-4-1">
    
    <label class="md-nav__link" for="nav-2-4-1">
      BUUCTF
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-1">
        BUUCTF
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/misc/" title="MISC" class="md-nav__link">
      MISC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/buuctf/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-2" type="checkbox" id="nav-2-4-2">
    
    <label class="md-nav__link" for="nav-2-4-2">
      旧版Bugku
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-2">
        旧版Bugku
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/old_bugku/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-3" type="checkbox" id="nav-2-4-3">
    
    <label class="md-nav__link" for="nav-2-4-3">
      实验吧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-3">
        实验吧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exams/shiyanba/reverse/" title="Reverse" class="md-nav__link">
      Reverse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sao/reverse_box/" title="SAO" class="md-nav__link">
      SAO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      CTF Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        CTF Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/z3/" title="Z3" class="md-nav__link">
      Z3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/xortool/" title="Xortool" class="md-nav__link">
      Xortool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ctf_tools/ida_python/" title="IDA python" class="md-nav__link">
      IDA python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      SZU OJ Solution
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        SZU OJ Solution
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      数据结构
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        数据结构
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/introdution/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-2" type="checkbox" id="nav-4-1-2">
    
    <label class="md-nav__link" for="nav-4-1-2">
      顺序表
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-2">
        顺序表
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1003/1017/" title="DS顺序表--类实现" class="md-nav__link">
      DS顺序表--类实现
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1003/1018/" title="DS顺序表--连续操作" class="md-nav__link">
      DS顺序表--连续操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1003/1019/" title="DS顺序表--合并操作" class="md-nav__link">
      DS顺序表--合并操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1003/1020/" title="DS顺序表之循环移位" class="md-nav__link">
      DS顺序表之循环移位
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-3" type="checkbox" id="nav-4-1-3">
    
    <label class="md-nav__link" for="nav-4-1-3">
      单链表
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-3">
        单链表
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1017/1021/" title="DS单链表--类实现" class="md-nav__link">
      DS单链表--类实现
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1017/1022/" title="DS单链表--结点交换" class="md-nav__link">
      DS单链表--结点交换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1017/1023/" title="DS单链表--合并" class="md-nav__link">
      DS单链表--合并
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1017/1029/" title="DS循环链表—约瑟夫环(Ver. I - A)" class="md-nav__link">
      DS循环链表—约瑟夫环(Ver. I - A)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-4" type="checkbox" id="nav-4-1-4">
    
    <label class="md-nav__link" for="nav-4-1-4">
      链表和栈
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-4">
        链表和栈
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1031/" title="DS堆栈--逆序输出（STL栈使用）" class="md-nav__link">
      DS堆栈--逆序输出（STL栈使用）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1033/" title="DS堆栈--行编辑" class="md-nav__link">
      DS堆栈--行编辑
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1036/" title="DS堆栈--字符替换" class="md-nav__link">
      DS堆栈--字符替换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1024/" title="DS线性表—多项式相加" class="md-nav__link">
      DS线性表—多项式相加
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1025/" title="DS链表—学生宿舍管理" class="md-nav__link">
      DS链表—学生宿舍管理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1029/1109/" title="DS双向链表—祖玛" class="md-nav__link">
      DS双向链表—祖玛
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-5" type="checkbox" id="nav-4-1-5">
    
    <label class="md-nav__link" for="nav-4-1-5">
      栈
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-5">
        栈
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1049/1034/" title="DS堆栈--括号匹配" class="md-nav__link">
      DS堆栈--括号匹配
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1049/1040/" title="DS栈—排队游戏" class="md-nav__link">
      DS栈—排队游戏
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1049/1041/" title="DS栈--Web导航" class="md-nav__link">
      DS栈--Web导航
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1049/1035/" title="DS堆栈--表达式计算" class="md-nav__link">
      DS堆栈--表达式计算
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1049/1032/" title="DS堆栈--迷宫求解" class="md-nav__link">
      DS堆栈--迷宫求解
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-6" type="checkbox" id="nav-4-1-6">
    
    <label class="md-nav__link" for="nav-4-1-6">
      队列
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-6">
        队列
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1062/1037/" title="DS队列之银行排队" class="md-nav__link">
      DS队列之银行排队
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1062/1112/" title="DS队列----银行简单模拟" class="md-nav__link">
      DS队列----银行简单模拟
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1062/1038/" title="DS队列+堆栈--数制转换" class="md-nav__link">
      DS队列+堆栈--数制转换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1062/1039/" title="DS队列--组队列" class="md-nav__link">
      DS队列--组队列
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1062/1113/" title="DS队列----银行单队列多窗口模拟" class="md-nav__link">
      DS队列----银行单队列多窗口模拟
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-7" type="checkbox" id="nav-4-1-7">
    
    <label class="md-nav__link" for="nav-4-1-7">
      串应用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-7">
        串应用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1070/1043/" title="DS串应用--KMP算法" class="md-nav__link">
      DS串应用--KMP算法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1070/1044/" title="DS串应用--串替换" class="md-nav__link">
      DS串应用--串替换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1070/1046/" title="DS串应用—最长重复子串" class="md-nav__link">
      DS串应用—最长重复子串
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1070/1045/" title="串应用- 计算一个串的最长的真前后缀" class="md-nav__link">
      串应用- 计算一个串的最长的真前后缀
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1070/1047/" title="子串循环问题 (Ver. I)" class="md-nav__link">
      子串循环问题 (Ver. I)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-8" type="checkbox" id="nav-4-1-8">
    
    <label class="md-nav__link" for="nav-4-1-8">
      二叉树及其应用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-8">
        二叉树及其应用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1050/" title="DS二叉树—二叉树构建与遍历（不含框架）" class="md-nav__link">
      DS二叉树—二叉树构建与遍历（不含框架）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1054/" title="DS二叉树——二叉树之数组存储" class="md-nav__link">
      DS二叉树——二叉树之数组存储
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1051/" title="DS二叉树--叶子数量" class="md-nav__link">
      DS二叉树--叶子数量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1062/" title="DS树--二叉树高度" class="md-nav__link">
      DS树--二叉树高度
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1053/" title="DS二叉树——二叉树之父子结点" class="md-nav__link">
      DS二叉树——二叉树之父子结点
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1071/1055/" title="DS二叉树--层次遍历" class="md-nav__link">
      DS二叉树--层次遍历
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-9" type="checkbox" id="nav-4-1-9">
    
    <label class="md-nav__link" for="nav-4-1-9">
      Huffman树及其应用
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-9">
        Huffman树及其应用
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1092/1060/" title="DS二叉树——Huffman编码与解码（不含代码框架）" class="md-nav__link">
      DS二叉树——Huffman编码与解码（不含代码框架）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1092/1063/" title="DS树--二叉树之最大路径" class="md-nav__link">
      DS树--二叉树之最大路径
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1092/1061/" title="DS树--带权路径和" class="md-nav__link">
      DS树--带权路径和
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/data_structure/1092/1067/" title="DS二叉树—二叉树镜面反转" class="md-nav__link">
      DS二叉树—二叉树镜面反转
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      C++
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        C++
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1">
    
    <label class="md-nav__link" for="nav-4-2-1">
      指针
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-1">
        指针
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1035/" title="三数论大小（指针）" class="md-nav__link">
      三数论大小（指针）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1043/" title="成绩查询（指针运算）" class="md-nav__link">
      成绩查询（指针运算）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1038/" title="三串合一（指针与字符数组）" class="md-nav__link">
      三串合一（指针与字符数组）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1036/" title="货币兑换（指针与常量）" class="md-nav__link">
      货币兑换（指针与常量）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1046/" title="密钥加密法（指针应用）" class="md-nav__link">
      密钥加密法（指针应用）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1037/" title="动态数组（指针与数组）" class="md-nav__link">
      动态数组（指针与数组）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1044/" title="动态矩阵（指针与堆内存分配）" class="md-nav__link">
      动态矩阵（指针与堆内存分配）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1039/" title="矩阵左转（指针与数组）" class="md-nav__link">
      矩阵左转（指针与数组）
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../szu_oj/cplusplus/1256/1045/" title="函数调用（函数指针）" class="md-nav__link">
      函数调用（函数指针）
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      MISC
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        MISC
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/ubuntu64_32/" title="Ubuntu18.04 64位=>32位程序问题" class="md-nav__link">
      Ubuntu18.04 64位=>32位程序问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/python_http_server/" title="Python SimpleHTTPServer" class="md-nav__link">
      Python SimpleHTTPServer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/python_script/" title="python脚本" class="md-nav__link">
      python脚本
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4">
    
    <label class="md-nav__link" for="nav-5-4">
      提问的智慧
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-4">
        提问的智慧
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/before_you_ask/" title="在提问之前" class="md-nav__link">
      在提问之前
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/when_you_ask/" title="当你在提问时" class="md-nav__link">
      当你在提问时
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_interpret_answers/" title="如何解读答案" class="md-nav__link">
      如何解读答案
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/on_not_reacting_like_loser/" title="如何避免扮演失败者" class="md-nav__link">
      如何避免扮演失败者
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/questions_not_to_ask/" title="不该问的问题" class="md-nav__link">
      不该问的问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/good_and_bad_questions/" title="好问题与蠢问题" class="md-nav__link">
      好问题与蠢问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/if_you_cant_get_an_answer/" title="如果得不到回答" class="md-nav__link">
      如果得不到回答
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_answer_questions_in_a_helpful_way/" title="如何更好地回答问题" class="md-nav__link">
      如何更好地回答问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/how_to_ask_questions_the_smart_way/how_to_ask_questions_the_smart_way/" title="完整版" class="md-nav__link">
      完整版
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-5" type="checkbox" id="nav-5-5">
    
    <label class="md-nav__link" for="nav-5-5">
      Install WSL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-5">
        Install WSL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/install/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/mklink/" title="mklink软链接到非系统盘" class="md-nav__link">
      mklink软链接到非系统盘
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/optimization/" title="子系统优化" class="md-nav__link">
      子系统优化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/questions/" title="杂七杂八问题" class="md-nav__link">
      杂七杂八问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../misc/wsl/reference/" title="参考资料" class="md-nav__link">
      参考资料
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/dynamic_static_linking/" title="静态/动态 链接" class="md-nav__link">
      静态/动态 链接
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      Pwn
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/pwn/function/" title="函数" class="md-nav__link">
      函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/pwn/Glibc_Ptmalloc2/" title="glibc内存管理ptmalloc源代码分析" class="md-nav__link">
      glibc内存管理ptmalloc源代码分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/big_little_ending/" title="大端序和小端序" class="md-nav__link">
      大端序和小端序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      C++
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        C++
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/cpp/cpp/" title="笔记" class="md-nav__link">
      笔记
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/cpp/keywords/" title="关键字(保留字)" class="md-nav__link">
      关键字(保留字)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/base58/" title="Base58" class="md-nav__link">
      Base58
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      操作系统
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        操作系统
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../notes/OS/fork/" title="fork()" class="md-nav__link">
      fork()
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#justre" class="md-nav__link">
    JustRe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_ad" class="md-nav__link">
    强网先锋_AD
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webassembly" class="md-nav__link">
    webassembly
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Alikas0/blog_code/tree/master/blog_code/edit/master/docs/ctf_write_up/2019/2019qwb.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>2019 强网杯</h1>
                
                <p>2019强网杯线上赛RE-部分write up</p>
<p>这算是第一次参加正式比赛并且做出题目，记录一下！</p>
<p>虽然只是做出了两道很简单的题目0.0.....</p>
<p>比赛后在Apeng大佬的帮助下做出了wasm。</p>
<p>我真的是，太菜了........膜拜Apeng大佬！人又帅又会打CTF！</p>
<ul>
<li>2019.6.15更新，上传三道题的原题</li>
</ul>
<h2 id="justre">JustRe</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rar">JustRe</a></p>
<p>打开来是这个样子，拖进IDA通过字符，定位到主函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kt">int</span> <span class="nf">sub_401BD0</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-68h]</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      #                        ######         &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    #  ####  #####    #     # ###### &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    # #        #      #     # #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;      # #    #  ####    #      ######  #####  &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;#     # #    #      #   #      #   #   #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;#     # #    # #    #   #      #    #  #      &quot;</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; #####   ####   ####    #      #     # ###### &quot;</span><span class="p">);</span>
  <span class="n">sub_401CE0</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">sub_401610</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sub_4018A0</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;sorry..&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<p>重点在函数sub_401610()中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kt">signed</span> <span class="kt">int</span> <span class="n">__usercall</span> <span class="n">sub_401610</span><span class="err">@</span><span class="o">&lt;</span><span class="n">eax</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ecx</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ebp</span><span class="o">&gt;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// edi</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kr">__m128i</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// xmm5</span>
  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// cl</span>
  <span class="kt">char</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// ch</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// ch</span>
  <span class="kt">char</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// dl</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// dh</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v17</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kr">__m128i</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// xmm0</span>
  <span class="kr">__m128i</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// xmm0</span>
  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">v20</span><span class="p">;</span> <span class="c1">// esi</span>
  <span class="kr">__m128i</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// xmm4</span>
  <span class="kt">int</span> <span class="n">v22</span><span class="p">;</span> <span class="c1">// ecx</span>
  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v23</span><span class="p">;</span> <span class="c1">// rax</span>
  <span class="n">HANDLE</span> <span class="n">v24</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v26</span><span class="p">;</span> <span class="c1">// [esp-54h] [ebp-60h]</span>
  <span class="kr">__m128i</span> <span class="n">v27</span><span class="p">;</span> <span class="c1">// [esp-20h] [ebp-2Ch]</span>
  <span class="kt">int</span> <span class="n">v28</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-14h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v29</span><span class="p">;</span> <span class="c1">// [esp-2h] [ebp-Eh]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v30</span><span class="p">;</span> <span class="c1">// [esp-1h] [ebp-Dh]</span>
  <span class="kt">int</span> <span class="n">v31</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-Ch]</span>
  <span class="kt">int</span> <span class="n">v32</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-8h]</span>
  <span class="kt">int</span> <span class="n">retaddr</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp+0h]</span>

  <span class="n">v31</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
  <span class="n">v32</span> <span class="o">=</span> <span class="n">retaddr</span><span class="p">;</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="n">v26</span> <span class="o">=</span> <span class="n">__rdtsc</span><span class="p">();</span>
  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v4</span> <span class="o">+</span> <span class="n">a1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="n">v5</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_6</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">65</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
<span class="nl">LABEL_6</span><span class="p">:</span>
    <span class="n">v3</span> <span class="o">*=</span> <span class="mi">16</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v5</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9u</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
<span class="nl">LABEL_10</span><span class="p">:</span>
      <span class="n">v3</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="n">v7</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_11</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">&lt;=</span> <span class="mh">0x19u</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">55</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_10</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nl">LABEL_11</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">v4</span> <span class="o">&gt;=</span> <span class="mi">8</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v8</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">goto</span> <span class="n">LABEL_14</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">LABEL_14</span><span class="p">:</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="n">_mm_shuffle_epi32</span><span class="p">(</span><span class="n">_mm_cvtsi32_si128</span><span class="p">(</span><span class="n">v3</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v8</span> <span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&gt;=</span> <span class="mi">48</span> <span class="o">&amp;&amp;</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="n">v30</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_19</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v12</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">65</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
  <span class="p">{</span>
<span class="nl">LABEL_34</span><span class="p">:</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_35</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nl">LABEL_19</span><span class="p">:</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">);</span>
  <span class="n">v29</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">&lt;</span> <span class="mi">48</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="n">v29</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="o">&lt;=</span> <span class="mi">57</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_24</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">-</span> <span class="mi">65</span><span class="p">;</span>
  <span class="n">v30</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">LABEL_34</span><span class="p">;</span>
<span class="nl">LABEL_24</span><span class="p">:</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">48</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">9u</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v30</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
      <span class="n">v15</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="n">v15</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="p">(</span><span class="n">v10</span> <span class="o">-</span> <span class="mi">7</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">v10</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v16</span> <span class="o">&lt;=</span> <span class="mi">9u</span> <span class="p">)</span>
    <span class="k">goto</span> <span class="n">LABEL_33</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">&gt;</span> <span class="mh">0x19u</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v16</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nl">LABEL_33</span><span class="p">:</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="n">v16</span><span class="p">;</span>
    <span class="n">v17</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">LABEL_35</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">9</span><span class="p">)</span> <span class="o">-</span> <span class="mi">55</span><span class="p">;</span>
<span class="nl">LABEL_35</span><span class="p">:</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">_mm_cvtsi32_si128</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">v11</span><span class="p">);</span>
  <span class="n">v19</span> <span class="o">=</span> <span class="n">_mm_unpacklo_epi8</span><span class="p">(</span><span class="n">v18</span><span class="p">,</span> <span class="n">v18</span><span class="p">);</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="n">_mm_shuffle_epi32</span><span class="p">(</span><span class="n">_mm_unpacklo_epi16</span><span class="p">(</span><span class="n">v19</span><span class="p">,</span> <span class="n">v19</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v17</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v20</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dword_4053C4</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v20</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
      <span class="n">v21</span> <span class="o">=</span> <span class="n">_mm_mullo_epi32</span><span class="p">(</span><span class="n">_mm_cvtepu8_epi32</span><span class="p">(</span><span class="n">_mm_cvtsi32_si128</span><span class="p">(</span><span class="n">v27</span><span class="p">.</span><span class="n">m128i_u32</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404380</span><span class="p">);</span>
      <span class="n">xmmword_405018</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">,</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405018</span><span class="p">));</span>
      <span class="n">xmmword_405028</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404350</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405028</span><span class="p">));</span>
      <span class="n">xmmword_405038</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404360</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405038</span><span class="p">));</span>
      <span class="n">xmmword_405048</span> <span class="o">=</span> <span class="p">(</span><span class="n">__int128</span><span class="p">)</span><span class="n">_mm_xor_si128</span><span class="p">(</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">_mm_add_epi32</span><span class="p">((</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404370</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_404340</span><span class="p">),</span> <span class="n">v9</span><span class="p">),</span>
                                   <span class="n">_mm_add_epi32</span><span class="p">(</span><span class="n">v21</span><span class="p">,</span> <span class="p">(</span><span class="kr">__m128i</span><span class="p">)</span><span class="n">xmmword_405048</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v20</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v20</span> <span class="o">+</span> <span class="n">v3</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">16843009</span> <span class="o">*</span> <span class="n">v11</span> <span class="o">+</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v20</span><span class="p">));</span>
      <span class="o">++</span><span class="n">v20</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">v20</span> <span class="o">&lt;</span> <span class="mi">24</span> <span class="p">);</span>
    <span class="n">v22</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">xmmword_405018</span> <span class="o">+</span> <span class="n">v22</span><span class="p">)</span> <span class="o">==</span> <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">loc_404148</span> <span class="o">+</span> <span class="n">v22</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">++</span><span class="n">v22</span> <span class="o">&gt;=</span> <span class="mi">96</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v28</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">v23</span> <span class="o">=</span> <span class="n">__rdtsc</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v23</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">v28</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">)</span>
          <span class="n">MEMORY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">v24</span> <span class="o">=</span> <span class="n">GetCurrentProcess</span><span class="p">();</span>
        <span class="n">WriteProcessMemory</span><span class="p">(</span><span class="n">v24</span><span class="p">,</span> <span class="n">sub_4018A0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">xmmword_405018</span><span class="p">,</span> <span class="mh">0x60u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<p>看不是特别懂，但也能从中读到一点东西。</p>
<p><code>if ( ++v4 &gt;= 8 )</code>可知输入字符串至少为8位</p>
<p>之后就直接动态调试了，这里用的是x32dbg</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401636  | 8A343E                      | mov dh,byte ptr ds:[esi+edi]                 |</span>
<span class="err">00401639  | 80FE 30                     | cmp dh,30                                    | 30:&#39;0&#39;</span>
<span class="err">0040163C  | 7C 0C                       | jl justre.40164A                             |</span>
<span class="err">0040163E  | 80FE 39                     | cmp dh,39                                    | 39:&#39;9&#39;</span>
<span class="err">00401641  | 7F 07                       | jg justre.40164A                             |</span>
<span class="err">00401643  | 8AD6                        | mov dl,dh                                    |</span>
<span class="err">00401645  | 80EA 41                     | sub dl,41                                    |</span>
<span class="err">00401648  | EB 0A                       | jmp justre.401654                            |</span>
<span class="err">0040164A  | 8AD6                        | mov dl,dh                                    |</span>
<span class="err">0040164C  | 80EA 41                     | sub dl,41                                    |</span>
<span class="err">0040164F  | 80FA 19                     | cmp dl,19                                    |</span>
<span class="err">00401652  | 77 2C                       | ja justre.401680                             |</span>
<span class="err">00401654  | 8ACE                        | mov cl,dh                                    |</span>
<span class="err">00401656  | C1E0 04                     | shl eax,4                                    |</span>
<span class="err">00401659  | 80E9 30                     | sub cl,30                                    |</span>
<span class="err">0040165C  | 80F9 09                     | cmp cl,9                                     | 9:&#39;\t&#39;</span>
<span class="err">0040165F  | 77 05                       | ja justre.401666                             |</span>
<span class="err">00401661  | 83C0 D0                     | add eax,FFFFFFD0                             |</span>
<span class="err">00401664  | EB 08                       | jmp justre.40166E                            |</span>
<span class="err">00401666  | 80FA 19                     | cmp dl,19                                    |</span>
<span class="err">00401669  | 77 08                       | ja justre.401673                             |</span>
<span class="err">0040166B  | 83C0 C9                     | add eax,FFFFFFC9                             |</span>
<span class="err">0040166E  | 0FBECE                      | movsx ecx,dh                                 |</span>
<span class="err">00401671  | 03C1                        | add eax,ecx                                  |</span>
<span class="err">00401673  | 46                          | inc esi                                      |</span>
<span class="err">00401674  | 83FE 08                     | cmp esi,8                                    |</span>
<span class="err">00401677  | 7C BD                       | jl justre.401636                             |</span>
</code></pre></div>
</td></tr></table>

<p>这里是判断函数的第一个循环，用黑盒直接猜测，这里是读取前8位字符到eax</p>
<p><img alt="1558934804066" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558934804066.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401682  | 66:0F6EC0                   | movd xmm0,eax                                |</span>
<span class="err">00401686  | 66:0F70E8 00                | pshufd xmm5,xmm0,0                           |</span>
</code></pre></div>
</td></tr></table>

<p>这两句，将前八为扩展到xmm5中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">xmm5                12345678123456781234567812345678</span>
</code></pre></div>
</td></tr></table>

<p>这一句，读取了后两位，所以从这里可以知道输入字符至少10位</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401693  | 8A57 08                     | mov dl,byte ptr ds:[edi+8]                   | edi+8:&quot;AB&quot;</span>
</code></pre></div>
</td></tr></table>

<p>继续黑盒，可知，在这几句之前的语句都是在执行将后两位读取到ecx中，而这几句则是将其扩展到xmm0中</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401728  | 0FBECE                      | movsx ecx,dh                                 |</span>
<span class="err">0040172B  | 66:0F6EC1                   | movd xmm0,ecx                                |</span>
<span class="err">0040172F  | 66:0F60C0                   | punpcklbw xmm0,xmm0                          |</span>
<span class="err">00401733  | 66:0F61C0                   | punpcklwd xmm0,xmm0                          |</span>
<span class="err">00401737  | 66:0F70C0 00                | pshufd xmm0,xmm0,0                           |</span>
<span class="err">0040173C  | 0F2945 E0                   | movaps xmmword ptr ss:[ebp-20],xmm0          |</span>
</code></pre></div>
</td></tr></table>

<p><img alt="1558935387042" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558935387042.png" /></p>
<p>接下来由单步调试就可知,将下面，每次读取16个16进制字符进行运算(最后两组是分别进行，每次读取4个16进制字符)：</p>
<p>先分别加上后两位，这里就是加上AB，再每八位，和前八位加上i的数异或后再送回[00405018]</p>
<p>例如：3E5F11D5FE0F0B1DEA90BD987BB39408加上ABABABABABABABABABABABABABABABAB，在和12345678123456781234567812345678加上00000003000000020000000100000000后的1234567B1234567A1234567912345678异或后得F83EEBFBBB8EE0B284083F3A356B69CB，然后送回[00405018]</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00405010                          08 94 B3 7B 98 BD 90 EA  /.........³{.½.ê  </span>
<span class="err">00405020  1D 0B 0F FE D5 11 5F 3E 37 FC CA 85 B4 F1 3A FC  ...þÕ._&gt;7üÊ.´ñ:ü  </span>
<span class="err">00405030  39 0D 16 EE 35 75 50 3E 3B 6D CF 3D FC 0C 5D 07  9..î5uP&gt;;mÏ=ü.].  </span>
<span class="err">00405040  2E 51 EB 29 EF BB 16 58 3C 85 50 3E 40 2F 16 B0  .Që)ï».X&lt;.P&gt;@/.°  </span>
<span class="err">00405050  FD F0 4E 07 32 4E 19 64 03 95 4B 22 00 9A 8B 22  ýðN.2N.d..K&quot;...&quot;  </span>
<span class="err">00405060  91 0E 0F FE 1C 0D 5F 07 38 51 EB F9 A0 65 16 FE  ...þ.._.8Qëù e.þ  </span>
<span class="err">00405070  49 33 4F 89 C6 F1 56 FC                          I3O.ÆñVü</span>
<span class="err">_____________________________________________________________________________</span>
<span class="err">00405010                          CB 69 6B 35 3A 3F 08 84  /.......Ëik5:?..  </span>
<span class="err">00405020  B2 E0 8E BB FB EB 3E F8 37 FC CA 85 B4 F1 3A FC  ²à.»ûë&gt;ø7üÊ.´ñ:ü  </span>
<span class="err">00405030  39 0D 16 EE 35 75 50 3E 3B 6D CF 3D FC 0C 5D 07  9..î5uP&gt;;mÏ=ü.].  </span>
<span class="err">00405040  2E 51 EB 29 EF BB 16 58 3C 85 50 3E 40 2F 16 B0  .Që)ï».X&lt;.P&gt;@/.°  </span>
<span class="err">00405050  FD F0 4E 07 32 4E 19 64 03 95 4B 22 00 9A 8B 22  ýðN.2N.d..K&quot;...&quot;  </span>
<span class="err">00405060  91 0E 0F FE 1C 0D 5F 07 38 51 EB F9 A0 65 16 FE  ...þ.._.8Qëù e.þ  </span>
<span class="err">00405070  49 33 4F 89 C6 F1 56 FC                          I3O.ÆñVü</span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401831  | 8A81 18504000               | mov al,byte ptr ds:[ecx+405018]              |</span>
<span class="err">00401837  | 3A81 48414000               | cmp al,byte ptr ds:[ecx+404148]              |</span>
<span class="err">0040183D  | 75 4F                       | jne justre.40188E                            |</span>
<span class="err">0040183F  | 41                          | inc ecx                                      |</span>
<span class="err">00401840  | 83F9 60                     | cmp ecx,60                                   |</span>
<span class="err">00401843  | 7C EC                       | jl justre.401831                             |</span>
</code></pre></div>
</td></tr></table>

<p>上面这几句则是将运算后的字符和[404148]处的字符进行对比，即是主函数中的（一开始IDA给识别成了语句，直接undifine即可）</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="c1">; _BYTE byte_404148[96]</span>
<span class="nl">.rdata:</span><span class="err">00404148</span> <span class="nf">byte_404148</span>     <span class="no">db</span> <span class="mi">55</span><span class="no">h</span><span class="p">,</span> <span class="mi">8</span><span class="no">Bh</span><span class="p">,</span> <span class="mi">0</span><span class="no">ECh</span><span class="p">,</span> <span class="mi">83</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">E4h</span><span class="p">,</span> <span class="mi">0</span><span class="no">F0h</span><span class="p">,</span> <span class="mi">81</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">ECh</span><span class="p">,</span> <span class="mi">78</span><span class="no">h</span><span class="p">,</span> <span class="mi">2</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                                         <span class="c1">; DATA XREF: sub_401610+227↑r</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">2</span> <span class="no">dup</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="no">A1h</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="no">h</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">33</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">C4h</span><span class="p">,</span> <span class="mi">89</span><span class="no">h</span><span class="p">,</span> <span class="mi">84</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">74</span><span class="no">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="no">dup</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="no">A8h</span><span class="p">,</span> <span class="mi">41</span><span class="no">h</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="no">A0h</span><span class="p">,</span> <span class="mi">0</span><span class="no">C0h</span><span class="p">,</span> <span class="mi">41</span><span class="no">h</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">56</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">11</span><span class="no">h</span><span class="p">,</span> <span class="mi">44</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">2</span><span class="no">Ch</span><span class="p">,</span> <span class="mi">57</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">F3h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">7</span><span class="no">Eh</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="no">B8h</span><span class="p">,</span> <span class="mi">41</span><span class="no">h</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">0</span><span class="no">D6h</span><span class="p">,</span> <span class="mi">44</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">10</span><span class="no">h</span><span class="p">,</span> <span class="mi">41</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Ah</span><span class="p">,</span> <span class="mi">6</span><span class="no">Ah</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">88</span><span class="no">h</span><span class="p">,</span> <span class="mi">44</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">4</span><span class="no">Ch</span><span class="p">,</span> <span class="mi">8</span><span class="no">Dh</span><span class="p">,</span> <span class="mi">84</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">FCh</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="no">dup</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">6</span><span class="no">Ah</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span><span class="p">,</span> <span class="mi">11</span><span class="no">h</span><span class="p">,</span> <span class="mi">44</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">1</span><span class="no">Ch</span><span class="p">,</span> <span class="mi">0</span><span class="no">E8h</span><span class="p">,</span> <span class="mi">58</span><span class="no">h</span><span class="p">,</span> <span class="mi">0</span><span class="no">Fh</span>
<span class="nl">.rdata:</span><span class="err">00404148</span>                 <span class="nf">db</span> <span class="mi">2</span> <span class="no">dup</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">6</span><span class="no">Ah</span><span class="p">,</span> <span class="mi">40</span><span class="no">h</span><span class="p">,</span> <span class="mi">8</span><span class="no">Dh</span><span class="p">,</span> <span class="mi">84</span><span class="no">h</span><span class="p">,</span> <span class="mi">24</span><span class="no">h</span><span class="p">,</span> <span class="mi">48</span><span class="no">h</span><span class="p">,</span> <span class="mi">2</span>
<span class="nl">.rdata:</span><span class="err">004041</span><span class="nf">A8</span>                 <span class="no">xmmword</span> <span class="mi">4</span><span class="no">E434158435843594445434641534641h</span>
<span class="nl">.rdata:</span><span class="err">004041</span><span class="nf">B8</span>                 <span class="no">dq</span> <span class="mi">43585143444</span><span class="no">B4644h</span>
<span class="nl">.rdata:</span><span class="err">004041</span><span class="nf">C0</span>                 <span class="no">db</span> <span class="mi">0</span>
</code></pre></div>
</td></tr></table>

<p>知道了运算过程，那就可以来解出前10位：我这里通过先求出前八位,再求出后两位的方法</p>
<p>因为前八位，对相邻的4个16进制数操作相差为1，则可通过最初的两位求出满足条件的8位数,再相减求出满足相差为1的且参与运算的后两位是相同的前八位，再通过已知前八位来算出后两位</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">]</span>

<span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mh">0XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">aa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>

<span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mh">0XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
        <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">break</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>
<span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span> <span class="nb">hex</span><span class="p">((</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>最终得到：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">0x13242248L</span>
<span class="err">0x15151515L</span>
</code></pre></div>
</td></tr></table>

<p>即前10位为<code>1324224815</code>，但输进去还是sorry，那就是后面还有一些东西</p>
<p>继续调试：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="mi">00401862</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mi">8900</span><span class="w">                        </span><span class="o">|</span><span class="w"> </span><span class="n">mov</span><span class="w"> </span><span class="n">dword</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="nl">ds</span><span class="p">:</span><span class="o">[</span><span class="n">eax</span><span class="o">]</span><span class="p">,</span><span class="n">eax</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code> <span class="k">if</span> <span class="p">(</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v23</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">HIDWORD</span><span class="p">(</span><span class="n">v26</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">v28</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)(</span><span class="n">v23</span> <span class="o">-</span> <span class="n">v26</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mh">0xFFFFFF</span><span class="p">)</span> <span class="p">)</span>
          <span class="n">MEMORY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</code></pre></div>
</td></tr></table>

<p>调试到这里程序会崩溃，根据IDA这里MEMORY[0] = 0也是分析不出来的，直接设下一句为新EIP即可</p>
<p>接着开始瞎猜模式.......</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401949  | 8B8424 F8010000             | mov eax,dword ptr ss:[esp+1F8]               |</span>
<span class="err">00401950  | 8D9424 70010000             | lea edx,dword ptr ss:[esp+170]               |</span>
<span class="err">00401957  | 83C4 18                     | add esp,18                                   |</span>
<span class="err">0040195A  | 898424 D8010000             | mov dword ptr ss:[esp+1D8],eax               |</span>
<span class="err">00401961  | 8B8424 E4010000             | mov eax,dword ptr ss:[esp+1E4]               |</span>
<span class="err">00401968  | 8D8C24 D8010000             | lea ecx,dword ptr ss:[esp+1D8]               |</span>
<span class="err">0040196F  | 898424 DC010000             | mov dword ptr ss:[esp+1DC],eax               |</span>
<span class="err">00401976  | E8 85F6FFFF                 | call &lt;justre.sub_401000&gt;                     |</span>
<span class="err">0040197B  | 8B8424 E8010000             | mov eax,dword ptr ss:[esp+1E8]               |</span>
<span class="err">00401982  | 8D9424 D8000000             | lea edx,dword ptr ss:[esp+D8]                |</span>
<span class="err">00401989  | 898424 D8010000             | mov dword ptr ss:[esp+1D8],eax               |</span>
<span class="err">00401990  | 8D8C24 D8010000             | lea ecx,dword ptr ss:[esp+1D8]               |</span>
<span class="err">00401997  | 8B8424 EC010000             | mov eax,dword ptr ss:[esp+1EC]               |</span>
<span class="err">0040199E  | 898424 DC010000             | mov dword ptr ss:[esp+1DC],eax               |</span>
<span class="err">004019A5  | E8 56F6FFFF                 | call &lt;justre.sub_401000&gt;                     |</span>
<span class="err">004019AA  | 8B8424 F0010000             | mov eax,dword ptr ss:[esp+1F0]               |</span>
<span class="err">004019B1  | 8D5424 58                   | lea edx,dword ptr ss:[esp+58]                |</span>
<span class="err">004019B5  | 898424 D8010000             | mov dword ptr ss:[esp+1D8],eax               |</span>
<span class="err">004019BC  | 8D8C24 D8010000             | lea ecx,dword ptr ss:[esp+1D8]               |</span>
<span class="err">004019C3  | 8B8424 F4010000             | mov eax,dword ptr ss:[esp+1F4]               |</span>
<span class="err">004019CA  | 898424 DC010000             | mov dword ptr ss:[esp+1DC],eax               |</span>
<span class="err">004019D1  | E8 2AF6FFFF                 | call &lt;justre.sub_401000&gt;                     |</span>
<span class="err">004019D6  | 8D7424 10                   | lea esi,dword ptr ss:[esp+10]                |</span>
<span class="err">004019DA  | 8D4E 01                     | lea ecx,dword ptr ds:[esi+1]                 |</span>
</code></pre></div>
</td></tr></table>

<p>通过这几个语句，将读进来的<code>AFSAFCEDYCXCXACNDFKDCQXC</code>分成三部分，并每部分都往前填充成一个新的字符串</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">&quot;AFSAFCEDAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="err">&quot;YCXCFACNAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="err">&quot;DFKDCQXCAFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
</code></pre></div>
</td></tr></table>

<p>中间这里，在前十位后由读进来了16个字符，并转化成16个16进制数，通过<code>call &lt;justre.sub_401500&gt;</code>加密，并且是分成两块进行加密，每次加密64位，加密运算后存储</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401A50  | 0FB68434 F9010000           | movzx eax,byte ptr ss:[esp+esi+1F9]          |</span>
<span class="err">00401A58  | 0FB68C34 F8010000           | movzx ecx,byte ptr ss:[esp+esi+1F8]          |</span>
<span class="err">00401A60  | 0FB69434 FC010000           | movzx edx,byte ptr ss:[esp+esi+1FC]          |</span>
<span class="err">00401A68  | C1E0 08                     | shl eax,8                                    |</span>
<span class="err">00401A6B  | 0BC8                        | or ecx,eax                                   |</span>
<span class="err">00401A6D  | 0FB68434 FA010000           | movzx eax,byte ptr ss:[esp+esi+1FA]          |</span>
<span class="err">00401A75  | C1E0 10                     | shl eax,10                                   |</span>
<span class="err">00401A78  | 0BC8                        | or ecx,eax                                   |</span>
<span class="err">00401A7A  | 0FB68434 FB010000           | movzx eax,byte ptr ss:[esp+esi+1FB]          |</span>
<span class="err">00401A82  | C1E0 18                     | shl eax,18                                   |</span>
<span class="err">00401A85  | 0BC8                        | or ecx,eax                                   |</span>
<span class="err">00401A87  | 0FB68434 FD010000           | movzx eax,byte ptr ss:[esp+esi+1FD]          |</span>
<span class="err">00401A8F  | 898C24 D8010000             | mov dword ptr ss:[esp+1D8],ecx               |</span>
<span class="err">00401A96  | 0FB68C34 FF010000           | movzx ecx,byte ptr ss:[esp+esi+1FF]          |</span>
<span class="err">00401A9E  | C1E0 08                     | shl eax,8                                    |</span>
<span class="err">00401AA1  | 0BD0                        | or edx,eax                                   |</span>
<span class="err">00401AA3  | C1E1 08                     | shl ecx,8                                    |</span>
<span class="err">00401AA6  | 0FB68434 FE010000           | movzx eax,byte ptr ss:[esp+esi+1FE]          |</span>
<span class="err">00401AAE  | 0BC8                        | or ecx,eax                                   |</span>
<span class="err">00401AB0  | 8D4424 58                   | lea eax,dword ptr ss:[esp+58]                |</span>
<span class="err">00401AB4  | C1E1 10                     | shl ecx,10                                   |</span>
<span class="err">00401AB7  | 0BCA                        | or ecx,edx                                   |</span>
<span class="err">00401AB9  | 8D9424 58010000             | lea edx,dword ptr ss:[esp+158]               |</span>
<span class="err">00401AC0  | 50                          | push eax                                     |</span>
<span class="err">00401AC1  | 8D8424 DC000000             | lea eax,dword ptr ss:[esp+DC]                |</span>
<span class="err">00401AC8  | 898C24 E0010000             | mov dword ptr ss:[esp+1E0],ecx               |</span>
<span class="err">00401ACF  | 50                          | push eax                                     |</span>
<span class="err">00401AD0  | 8D8C24 E0010000             | lea ecx,dword ptr ss:[esp+1E0]               |</span>
<span class="err">00401AD7  | E8 24FAFFFF                 | call &lt;justre.sub_401500&gt;                     |                                            前面是取，后面是存储，函数用来加密运算</span>
<span class="err">00401ADC  | 8B8C24 E0010000             | mov ecx,dword ptr ss:[esp+1E0]               |</span>
<span class="err">00401AE3  | 83C4 08                     | add esp,8                                    |</span>
<span class="err">00401AE6  | 888C34 38020000             | mov byte ptr ss:[esp+esi+238],cl             |</span>
<span class="err">00401AED  | 8BC1                        | mov eax,ecx                                  |</span>
<span class="err">00401AEF  | C1E8 08                     | shr eax,8                                    |</span>
<span class="err">00401AF2  | 888434 39020000             | mov byte ptr ss:[esp+esi+239],al             |</span>
<span class="err">00401AF9  | 8BC1                        | mov eax,ecx                                  |</span>
<span class="err">00401AFB  | C1E8 10                     | shr eax,10                                   |</span>
<span class="err">00401AFE  | 888434 3A020000             | mov byte ptr ss:[esp+esi+23A],al             |</span>
<span class="err">00401B05  | C1E9 18                     | shr ecx,18                                   |</span>
<span class="err">00401B08  | 888C34 3B020000             | mov byte ptr ss:[esp+esi+23B],cl             |</span>
<span class="err">00401B0F  | 8B8C24 DC010000             | mov ecx,dword ptr ss:[esp+1DC]               |</span>
<span class="err">00401B16  | 8BC1                        | mov eax,ecx                                  |</span>
<span class="err">00401B18  | 888C34 3C020000             | mov byte ptr ss:[esp+esi+23C],cl             |</span>
<span class="err">00401B1F  | C1E8 08                     | shr eax,8                                    |</span>
<span class="err">00401B22  | 888434 3D020000             | mov byte ptr ss:[esp+esi+23D],al             |</span>
<span class="err">00401B29  | 8BC1                        | mov eax,ecx                                  |</span>
<span class="err">00401B2B  | C1E8 10                     | shr eax,10                                   |</span>
<span class="err">00401B2E  | C1E9 18                     | shr ecx,18                                   |</span>
<span class="err">00401B31  | 888434 3E020000             | mov byte ptr ss:[esp+esi+23E],al             |</span>
<span class="err">00401B38  | 888C34 3F020000             | mov byte ptr ss:[esp+esi+23F],cl             |</span>
<span class="err">00401B3F  | 83C6 08                     | add esi,8                                    |</span>
<span class="err">00401B42  | 3BF7                        | cmp esi,edi                                  | edi:&amp;&quot;D:\\CTF\\Games\\2019\\QWB\\task_JustRe5\\JustRe5\\JustRe.exe&quot;</span>
<span class="err">00401B44  | 0F8C 06FFFFFF               | jl justre.401A50                             |</span>
</code></pre></div>
</td></tr></table>

<p>最后这一部分是对比，而且对比的只有前4组，后两组数是固定不变的</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401B4A  | C74424 10 507CA9E6          | mov dword ptr ss:[esp+10],E6A97C50           |</span>
<span class="err">00401B52  | 33C0                        | xor eax,eax                                  |</span>
<span class="err">00401B54  | C74424 14 8709CEFA          | mov dword ptr ss:[esp+14],FACE0987           |</span>
<span class="err">00401B5C  | C74424 18 20D50DCF          | mov dword ptr ss:[esp+18],CF0DD520           |</span>
<span class="err">00401B64  | C74424 1C 90BB976C          | mov dword ptr ss:[esp+1C],6C97BB90           |</span>
<span class="err">00401B6C  | C74424 20 9090F6B0          | mov dword ptr ss:[esp+20],B0F69090           |</span>
<span class="err">00401B74  | C74424 24 7BA6A4E8          | mov dword ptr ss:[esp+24],E8A4A67B           |</span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">00401B80  | 8A4C04 10                   | mov cl,byte ptr ss:[esp+eax+10]              |</span>
<span class="err">00401B84  | 3A8C04 38020000             | cmp cl,byte ptr ss:[esp+eax+238]             |</span>
<span class="err">00401B8B  | 75 1F                       | jne justre.401BAC                            |</span>
</code></pre></div>
</td></tr></table>

<p>根据上面的分析，猜测这是一个64位的分块加密算法，查了一下发现是DES3</p>
<ul>
<li>```
  三重 DES 的加解密方式如下</li>
</ul>
<p>C=Ek3(Dk2(Ek1(P)))C=Ek3(Dk2(Ek1(P)))</p>
<p>P=Dk1(Ek2(Dk3(C)))P=Dk1(Ek2(Dk3(C)))</p>
<p>在选择密钥时，可以有两种方法</p>
<ul>
<li>3 个不同的密钥，k1，k2，k3 互相独立，一共 168 比特。</li>
<li>2 个不同的密钥，k1 与 k2 独立，k3=k1，112 比特。</li>
</ul>
<p>```</p>
<p>最后直接通过pyCrypto模块导入DES3，解出后16位，脚本如下如下</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;AFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span>
          <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">cipher</span><span class="p">))</span>
<span class="n">des3</span> <span class="o">=</span> <span class="n">DES3</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">des3</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">flag2</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>最终脚本：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">from</span> <span class="n">Crypto</span><span class="p">.</span><span class="n">Cipher</span> <span class="n">import</span> <span class="n">DES3</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">]</span>

<span class="n">aa</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">)</span><span class="o">:</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">:</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span><span class="n">XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="o">:</span>
        <span class="n">aa</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">aa</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>

<span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">)</span><span class="o">:</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">:</span>
        <span class="n">s1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="mi">0</span><span class="n">XFFFFFFF</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFFFFFFFF</span><span class="o">:</span>
        <span class="n">bb</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">key2</span><span class="p">)</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">bb</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">aa</span><span class="p">))</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">:</span>
        <span class="k">if</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span>
            <span class="n">print</span> <span class="n">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">break</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">]</span>
<span class="n">s1</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">]</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">print</span> <span class="n">hex</span><span class="p">((</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span> <span class="o">^</span> <span class="n">bb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">key2</span>

<span class="n">key</span> <span class="o">=</span> <span class="s">&quot;AFSAFCEDYCXCXACNDFKDCQXC&quot;</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span>
          <span class="mh">0xFA</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="n">chr</span><span class="p">,</span> <span class="n">cipher</span><span class="p">))</span>
<span class="n">des3</span> <span class="o">=</span> <span class="n">DES3</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="n">print</span> <span class="n">hex</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">2</span><span class="o">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="n">hex</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">2</span><span class="o">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="n">des3</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">flag2</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

<p>得flag{13242248150dcc509a6f75849b}</p>
<h2 id="_ad">强网先锋_AD</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rar%E5%BC%BA%E7%BD%91%E5%85%88%E5%B3%B0/qwb2019_misc.tar.gz">强网先锋_AD</a> </p>
<p>这道题就是一道水题0.0</p>
<p>下载后拖进IDA里打开，直接找到mian函数</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v4</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-150h]</span>
  <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">45</span><span class="p">];</span> <span class="c1">// [rsp+80h] [rbp-D0h]</span>
  <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+B0h] [rbp-A0h]</span>
  <span class="kr">__int64</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+B8h] [rbp-98h]</span>
  <span class="kr">__int64</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+C0h] [rbp-90h]</span>
  <span class="kr">__int16</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+C8h] [rbp-88h]</span>
  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+D0h] [rbp-80h]</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+140h] [rbp-10h]</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+14Ch] [rbp-4h]</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;=== Strong Network Pioneer === </span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">);</span>
  <span class="n">v6</span> <span class="o">=</span> <span class="mi">7953769703030221169LL</span><span class="p">;</span>
  <span class="n">v7</span> <span class="o">=</span> <span class="mi">7954876941086586983LL</span><span class="p">;</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="mi">7956005061827062375LL</span><span class="p">;</span>
  <span class="n">v9</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6D</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x78</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">86</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="mi">88</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="mi">112</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="mi">53</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">107</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">102</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="mi">81</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
  <span class="n">key</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
  <span class="n">v11</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v10</span><span class="p">;</span>
  <span class="n">sub_4005B7</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v10</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v4</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">44</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;you&#39;re not</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;yes, you are!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<p>最下面的循环是判断，也就是说我们输入的v4要和key相等</p>
<p>进入sub_4005B7</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_4005B7</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// ST18_4</span>
  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// eax</span>
  <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-10h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+17h] [rbp-9h]</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+17h] [rbp-9h]</span>
  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]</span>
  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [rsp+1Ch] [rbp-4h]</span>

  <span class="n">v16</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v10</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span> <span class="n">v16</span> <span class="o">&lt;</span> <span class="n">v10</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v2</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
    <span class="n">v14</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v2</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">];</span>
    <span class="n">v11</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="n">v16</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v4</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
      <span class="n">v5</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v4</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">v11</span><span class="p">];</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v5</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">v13</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v6</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
    <span class="n">v15</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v3</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">v11</span><span class="p">];</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3C</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="o">&lt;=</span> <span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v15</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">v12</span><span class="p">];</span>
      <span class="n">v8</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">v13</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v8</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v15</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[((</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">v12</span><span class="p">];</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">v13</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">v7</span><span class="p">)</span> <span class="o">=</span> <span class="n">base64</span><span class="p">[</span><span class="n">a1</span><span class="p">[</span><span class="n">v16</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
    <span class="n">v16</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">v13</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<p>看着很熟悉....直接就能找到base64加密table表</p>
<p><img alt="1558933633691" src="https://raw.githubusercontent.com/Alikas0/files/master/img/1558933633691.png" /></p>
<p>写个脚本跑一下，flag即出</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">import</span> <span class="n">base64</span>
<span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">45</span><span class="p">)]</span>

<span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span>
<span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6D</span>
<span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x78</span>
<span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">key</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>
<span class="n">key</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>
<span class="n">key</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">key</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">key</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">86</span>
<span class="n">key</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">key</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">key</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">97</span>
<span class="n">key</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="mi">88</span>
<span class="n">key</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">key</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="mi">112</span>
<span class="n">key</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="mi">53</span>
<span class="n">key</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">107</span>
<span class="n">key</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="mi">89</span>
<span class="n">key</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="mi">87</span>
<span class="n">key</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span>
<span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="mi">105</span>
<span class="n">key</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">102</span>
<span class="n">key</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="mi">81</span>
<span class="n">key</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span>
<span class="n">key</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">=</span> <span class="mi">61</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="o">:</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="n">chr</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="n">print</span> <span class="n">flag</span>
</code></pre></div>
</td></tr></table>

<p>flag{mafakuailaiqiandaob}</p>
<h2 id="webassembly">webassembly</h2>
<p>题目：<a href="https://raw.githubusercontent.com/Alikas0/CTF/master/challenges/2019/QWB/JustRe/JustRe.rarwebassembly/webassembly5.tar">webassembly</a></p>
<p>这是我第一次接触wasm，记录一下0.0</p>
<p>题目下下来只有三个文件，分别是<code>.js</code> , <code>.wasm</code>,<code>.html</code></p>
<p>wasm介绍就不在这里介绍了，有兴趣可以到这里看看</p>
<p>wasm就是一堆二进制文件，就很头秃。但可以用<a href="https://github.com/WebAssembly/wabt">wabt工具</a>转成<code>.c</code>和<code>.h</code>文件</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">$./wasm2c webassembly.wasm -o webassembly.c</span>
</code></pre></div>
</td></tr></table>

<p>不过还是看不懂，代码行数贼恐怖18567行..............后来Apeng大佬提供了一种优化方法：用gcc编译后在用ida反编译</p>
<p>将之前反编译出来的wasm.c，wasm.h，以及wabt项目内的wasm-rt.h，wasm-rt-impl.c，wasm-rt-impl.h三个文件放到同一个文件夹。</p>
<p>直接gcc wasm.c会报错，因为很多wasm的函数没有具体的实现。但是我们可以只编译不链接，我们关心的只是程序本身的逻辑，不需要真正编译出能运行的elf来。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">$gcc -c wasm.c -o wasm.o</span>
</code></pre></div>
</td></tr></table>

<p>得到的还未连接的elf文件wasm.o</p>
<p>现在就可以丢进ida来分析了，比之前的wasm.c友好很多。</p>
<p>分析出来是，XTEA加密，解密脚本(Apeng大佬太强了0.0)如下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;pch.h&quot;</span><span class="w"></span>
<span class="n">#include</span><span class="w"> </span><span class="o">&lt;</span><span class="n">iostream</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">namespace</span><span class="w"> </span><span class="n">std</span><span class="p">;</span><span class="w"></span>

<span class="n">void</span><span class="w"> </span><span class="n">encipher</span><span class="p">(</span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">num_rounds</span><span class="p">,</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">4</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x9E3779B9</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_rounds</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">        </span><span class="n">v0</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(((</span><span class="n">v1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">sum &amp; 3</span><span class="o">]</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="nf">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">delta</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">v1</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(((</span><span class="n">v0</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">v0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v0</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">(sum &gt;&gt; 11) &amp; 3</span><span class="o">]</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="w">    </span><span class="n">v</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v0</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>


<span class="n">void</span><span class="w"> </span><span class="n">decipher</span><span class="p">(</span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">num_rounds</span><span class="p">,</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">2</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">4</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">v1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x9E3779B9</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_rounds</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_rounds</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">        </span><span class="n">v1</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="p">(((</span><span class="n">v0</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">v0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v0</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">(sum &gt;&gt; 11) &amp; 3</span><span class="o">]</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="nf">sum</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">delta</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">v0</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="p">(((</span><span class="n">v1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">v1</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">v1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="nf">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">key</span><span class="o">[</span><span class="n">sum &amp; 3</span><span class="o">]</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="w">    </span><span class="n">v</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v0</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v1</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>

<span class="nc">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"></span>
<span class="err">{</span><span class="w"></span>

<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">v</span><span class="o">[</span><span class="n">10</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="mi">2586051617</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2764128737</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1835204653</span><span class="p">,</span><span class="w"> </span><span class="mi">2601945884</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">95579550</span><span class="p">,</span><span class="w"> </span><span class="mi">993221996</span><span class="p">,</span><span class="w"> </span><span class="mi">1624609160</span><span class="p">,</span><span class="w"> </span><span class="mi">781843991</span><span class="p">,</span><span class="w"> </span><span class="mi">879125044</span><span class="p">,</span><span class="mh">0x7D61</span><span class="w"> </span><span class="err">}</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">k</span><span class="o">[</span><span class="n">4</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="w"> </span><span class="err">}</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">decipher</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="nc">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2019starctf/" title="2019 *CTF" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                2019 *CTF
              </span>
            </div>
          </a>
        
        
          <a href="../2019redhat/" title="2019 红帽杯" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                2019 红帽杯
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Alikas0" target="_blank" rel="noopener" title="github" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://t.me/Alikas0" target="_blank" rel="noopener" title="telegram" class="md-footer-social__link fa fa-telegram"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.c33a9706.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.1",url:{base:"../../.."}})</script>
      
        <script src="../../../js/extra.js"></script>
      
        <script src="../../../js/gitalk.min.js"></script>
      
        <script src="../../../js/md5.min.js"></script>
      
    
  </body>
</html>